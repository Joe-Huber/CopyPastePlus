(()=>{"use strict";if(console.log("CopyPaste+ content script initializing",{href:location.href,topFrame:window.top===window}),"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.id){const e=window;if(e.__cpp_inited)console.debug("CopyPaste+ content: listeners already attached in this frame.");else{e.__cpp_inited=!0;const t=e=>{var t,n,o,i;try{const r=e.target;if(r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement){const e=null!==(t=r.selectionStart)&&void 0!==t?t:0,o=null!==(n=r.selectionEnd)&&void 0!==n?n:0;if(e!==o){const t=r.value.substring(e,o).trim();if(t)return t}}const c=null!==(i=null===(o=window.getSelection())||void 0===o?void 0:o.toString())&&void 0!==i?i:"";if(c.trim())return c.trim();if(e.clipboardData){const t=e.clipboardData.getData("text/plain");if(t&&t.trim())return t.trim()}}catch(e){console.error("CopyPaste+ content: error extracting copied text",e)}return null},n=e=>{try{chrome.runtime.sendMessage({type:"copiedText",text:e})}catch(e){console.error("CopyPaste+ content: failed to send message to background",e)}},o=e=>{try{const o=t(e);o&&(console.debug("CopyPaste+ captured text:",o.slice(0,200)),n(o))}catch(e){console.error("CopyPaste+ content: handler error",e)}};document.addEventListener("copy",o,!0),document.addEventListener("cut",o,!0),console.log("CopyPaste+ content script listeners attached")}}else console.warn("CopyPaste+ content: chrome.runtime unavailable in this frame; skipping listeners.")})();