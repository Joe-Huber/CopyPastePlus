(()=>{"use strict";chrome.runtime.onMessage.addListener((e,t,o)=>{if(console.log("Message received in background script:",e),"copiedText"===e.type){const t=e.text;chrome.storage.local.get({copiedItems:[]},e=>{console.log("Current items from storage:",e.copiedItems);let o=e.copiedItems;o.length>0&&"string"==typeof o[0]&&(o=o.map(e=>({id:self.crypto.randomUUID(),text:e,timestamp:Date.now(),favorite:!1,count:1})));const s=o.findIndex(e=>e.text===t);if(-1!==s)o[s].timestamp=Date.now(),o[s].count++;else{const e={id:self.crypto.randomUUID(),text:t,timestamp:Date.now(),favorite:!1,count:1};o.push(e)}o.sort((e,t)=>t.timestamp-e.timestamp),o.length>100&&(o=o.slice(0,100)),chrome.storage.local.set({copiedItems:o},()=>{console.log("Updated items saved to storage:",o)})})}})})();